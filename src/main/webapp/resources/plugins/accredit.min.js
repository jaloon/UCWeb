"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.bitArray={bitSlice:function(b,c,d){b=sjcl.bitArray._shiftRight(b.slice(c/32),32-(c&31)).slice(1);return(d===undefined)?b:sjcl.bitArray.clamp(b,d-c)},extract:function(c,d,f){var b,e=Math.floor((-d-f)&31);if((d+f-1^d)&-32){b=(c[d/32|0]<<(32-e))^(c[d/32+1|0]>>>e)}else{b=c[d/32|0]>>>e}return b&((1<<f)-1)},concat:function(c,a){if(c.length===0||a.length===0){return c.concat(a)}var d=c[c.length-1],b=sjcl.bitArray.getPartial(d);if(b===32){return c.concat(a)}else{return sjcl.bitArray._shiftRight(a,b,d|0,c.slice(0,c.length-1))}},bitLength:function(d){var c=d.length,b;if(c===0){return 0}b=d[c-1];return(c-1)*32+sjcl.bitArray.getPartial(b)},clamp:function(d,b){if(d.length*32<b){return d}d=d.slice(0,Math.ceil(b/32));var c=d.length;b=b&31;if(c>0&&b){d[c-1]=sjcl.bitArray.partial(b,d[c-1]&2147483648>>(b-1),1)}return d},partial:function(b,a,c){if(b===32){return a}return(c?a|0:a<<(32-b))+b*1099511627776},getPartial:function(a){return Math.round(a/1099511627776)||32},equal:function(e,d){if(sjcl.bitArray.bitLength(e)!==sjcl.bitArray.bitLength(d)){return false}var c=0,f;for(f=0;f<e.length;f++){c|=e[f]^d[f]}return(c===0)},_shiftRight:function(d,c,h,f){var g,b=0,e;if(f===undefined){f=[]}for(;c>=32;c-=32){f.push(h);h=0}if(c===0){return f.concat(d)}for(g=0;g<d.length;g++){f.push(h|d[g]>>>c);h=d[g]<<(32-c)}b=d.length?d[d.length-1]:0;e=sjcl.bitArray.getPartial(b);f.push(sjcl.bitArray.partial(c+e&31,(c+e>32)?h:f.pop(),1));return f},_xor4:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(c){var e,d,b=65280;for(e=0;e<c.length;++e){d=c[e];c[e]=(d>>>24)|((d>>>8)&b)|((d&b)<<8)|(d<<24)}return c}};sjcl.codec.base32={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",_hexChars:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(h,n,g){var l=sjcl.codec.base32.BITS,a=sjcl.codec.base32.BASE,j=sjcl.codec.base32.REMAINING;var d="",f,m=0,k=sjcl.codec.base32._chars,e=0,b=sjcl.bitArray.bitLength(h);if(g){k=sjcl.codec.base32._hexChars}for(f=0;d.length*a<b;){d+=k.charAt((e^h[f]>>>m)>>>j);if(m<a){e=h[f]<<(a-m);m+=j;f++}else{e<<=a;m-=a}}while((d.length&7)&&!n){d+="="}return d},toBits:function(l,g){l=l.replace(/\s|=/g,"").toUpperCase();var o=sjcl.codec.base32.BITS,a=sjcl.codec.base32.BASE,j=sjcl.codec.base32.REMAINING;var b=[],f,p=0,k=sjcl.codec.base32._chars,d=0,m,n="base32";if(g){k=sjcl.codec.base32._hexChars;n="base32hex"}for(f=0;f<l.length;f++){m=k.indexOf(l.charAt(f));if(m<0){if(!g){try{return sjcl.codec.base32hex.toBits(l)}catch(h){}}throw new sjcl.exception.invalid("this isn't "+n+"!")}if(p>j){p-=j;b.push(d^m>>>p);d=m<<(o-p)}else{p+=a;d^=m<<(o-p)}}if(p&56){b.push(sjcl.bitArray.partial(p&56,d,1))}return b}};sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};sjcl.codec.utf8String={fromBits:function(a){var b="",e=sjcl.bitArray.bitLength(a),d,c;for(d=0;d<e/8;d++){if((d&3)===0){c=a[d/4]}b+=String.fromCharCode(c>>>8>>>8>>>8);c<<=8}return decodeURIComponent(escape(b))},toBits:function(d){d=unescape(encodeURIComponent(d));var a=[],c,b=0;for(c=0;c<d.length;c++){b=b<<8|d.charCodeAt(c);if((c&3)===3){a.push(b);b=0}}if(c&3){a.push(sjcl.bitArray.partial(8*(c&3),b))}return a}};sjcl.hash.sha1=function(a){if(a){this._h=a._h.slice(0);this._buffer=a._buffer.slice(0);this._length=a._length}else{this.reset()}};sjcl.hash.sha1.hash=function(a){return(new sjcl.hash.sha1()).update(a).finalize()};sjcl.hash.sha1.prototype={blockSize:512,reset:function(){this._h=this._init.slice(0);this._buffer=[];this._length=0;return this},update:function(h){if(typeof h==="string"){h=sjcl.codec.utf8String.toBits(h)}var g,a=this._buffer=sjcl.bitArray.concat(this._buffer,h),f=this._length,d=this._length=f+sjcl.bitArray.bitLength(h);if(d>9007199254740991){throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits")}if(typeof Uint32Array!=="undefined"){var k=new Uint32Array(a);var e=0;for(g=this.blockSize+f-((this.blockSize+f)&(this.blockSize-1));g<=d;g+=this.blockSize){this._block(k.subarray(16*e,16*(e+1)));e+=1}a.splice(0,16*e)}else{for(g=this.blockSize+f-((this.blockSize+f)&(this.blockSize-1));g<=d;g+=this.blockSize){this._block(a.splice(0,16))}}return this},finalize:function(){var c,a=this._buffer,d=this._h;a=sjcl.bitArray.concat(a,[sjcl.bitArray.partial(1,1)]);for(c=a.length+2;c&15;c++){a.push(0)}a.push(Math.floor(this._length/4294967296));a.push(this._length|0);while(a.length){this._block(a.splice(0,16))}this.reset();return d},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(e,a,g,f){if(e<=19){return(a&g)|(~a&f)}else{if(e<=39){return a^g^f}else{if(e<=59){return(a&g)|(a&f)|(g&f)}else{if(e<=79){return a^g^f}}}}},_S:function(b,a){return(a<<b)|(a>>>32-b)},_block:function(n){var r,g,p,o,m,l,k,i=this._h;var q;if(typeof Uint32Array!=="undefined"){q=Array(80);for(var f=0;f<16;f++){q[f]=n[f]}}else{q=n}p=i[0];o=i[1];m=i[2];l=i[3];k=i[4];for(r=0;r<=79;r++){if(r>=16){q[r]=this._S(1,q[r-3]^q[r-8]^q[r-14]^q[r-16])}g=(this._S(5,p)+this._f(r,o,m,l)+k+q[r]+this._key[Math.floor(r/20)])|0;k=l;l=m;m=this._S(30,o);o=p;p=g}i[0]=(i[0]+p)|0;i[1]=(i[1]+o)|0;i[2]=(i[2]+m)|0;i[3]=(i[3]+l)|0;i[4]=(i[4]+k)|0}};sjcl.hash.sha256=function(a){if(!this._key[0]){this._precompute()}if(a){this._h=a._h.slice(0);this._buffer=a._buffer.slice(0);this._length=a._length}else{this.reset()}};sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256()).update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this._h=this._init.slice(0);this._buffer=[];this._length=0;return this},update:function(h){if(typeof h==="string"){h=sjcl.codec.utf8String.toBits(h)}var g,a=this._buffer=sjcl.bitArray.concat(this._buffer,h),f=this._length,d=this._length=f+sjcl.bitArray.bitLength(h);if(d>9007199254740991){throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits")}if(typeof Uint32Array!=="undefined"){var k=new Uint32Array(a);var e=0;for(g=512+f-((512+f)&511);g<=d;g+=512){this._block(k.subarray(16*e,16*(e+1)));e+=1}a.splice(0,16*e)}else{for(g=512+f-((512+f)&511);g<=d;g+=512){this._block(a.splice(0,16))}}return this},finalize:function(){var c,a=this._buffer,d=this._h;a=sjcl.bitArray.concat(a,[sjcl.bitArray.partial(1,1)]);for(c=a.length+2;c&15;c++){a.push(0)}a.push(Math.floor(this._length/4294967296));a.push(this._length|0);while(a.length){this._block(a.splice(0,16))}this.reset();return d},_init:[],_key:[],_precompute:function(){var d=0,c=2,b,e;function a(f){return(f-Math.floor(f))*4294967296|0}for(;d<64;c++){e=true;for(b=2;b*b<=c;b++){if(c%b===0){e=false;break}}if(e){if(d<8){this._init[d]=a(Math.pow(c,1/2))}this._key[d]=a(Math.pow(c,1/3));d++}}},_block:function(t){var e,f,s,r,j=this._h,c=this._key,q=j[0],p=j[1],o=j[2],n=j[3],m=j[4],l=j[5],g=j[6],d=j[7];for(e=0;e<64;e++){if(e<16){f=t[e]}else{s=t[(e+1)&15];r=t[(e+14)&15];f=t[e&15]=((s>>>7^s>>>18^s>>>3^s<<25^s<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+t[e&15]+t[(e+9)&15])|0}f=(f+d+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(g^m&(l^g))+c[e]);d=g;g=l;l=m;m=n+f|0;n=o;o=p;p=q;q=(f+((p&o)^(n&(p^o)))+(p>>>2^p>>>13^p>>>22^p<<30^p<<19^p<<10))|0}j[0]=j[0]+q|0;j[1]=j[1]+p|0;j[2]=j[2]+o|0;j[3]=j[3]+n|0;j[4]=j[4]+m|0;j[5]=j[5]+l|0;j[6]=j[6]+g|0;j[7]=j[7]+d|0}};sjcl.misc.hmac=function(d,e){this._hash=e=e||sjcl.hash.sha256;var c=[[],[]],b,a=e.prototype.blockSize/32;this._baseHash=[new e(),new e()];if(d.length>a){d=e.hash(d)}for(b=0;b<a;b++){c[0][b]=d[b]^909522486;c[1][b]=d[b]^1549556828}this._baseHash[0].update(c[0]);this._baseHash[1].update(c[1]);this._resultHash=new e(this._baseHash[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(!this._updated){this.update(a);return this.digest(a)}else{throw new sjcl.exception.invalid("encrypt on already updated hmac called!")}};sjcl.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]);this._updated=false};sjcl.misc.hmac.prototype.update=function(a){this._updated=true;this._resultHash.update(a)};sjcl.misc.hmac.prototype.digest=function(){var b=this._resultHash.finalize(),a=new (this._hash)(this._baseHash[1]).update(b).finalize();this.reset();return a};var __m_aucCardKey="OB2WY2LUN5XGOZDJMFXHU2LRNFQW4ZTFNZTWC3TROVQW42TJMFXGO5LBNZ4GS5DPNZTQ====";function HOTP(j,a,c){var m=sjcl.codec.base32.toBits(j,0);var g=[((a&18446744069414584000)>>32),a&4294967295];var e=new sjcl.misc.hmac(m,sjcl.hash.sha1);var b=e.encrypt(g);var f=sjcl.bitArray.extract(b,152,8)&15;var l=f*8;var d=l+4*8;var k=sjcl.bitArray.bitSlice(b,l,d);var i=k[0];var h=i&2147483647;var n=h%Math.pow(10,c);var o=n.toString();while(o.length<c){o="0"+o}return o}function randomNum(b,a){switch(arguments.length){case 1:return parseInt(Math.random()*b+1,10);case 2:return parseInt(Math.random()*(a-b+1)+b,10);default:return 0}}function getAuthPassword(e){if(e.length!=6){return""}var f=HOTP(__m_aucCardKey,parseInt(e),3);var a=100;var g=999;var d=0;var b=0;do{d=randomNum(a,g);b=f^d}while(b<100||b>999);var c=b*1000+d;return""+c};